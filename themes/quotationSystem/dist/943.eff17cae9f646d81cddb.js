(self.webpackChunkwr_frontend=self.webpackChunkwr_frontend||[]).push([[943],{7562:(e,o,t)=>{(o=t(3645)(!1)).push([e.id,"[data-v-482549f9] .config-dialog .el-dialog__body {\n  padding: 0 !important;\n}\n[data-v-482549f9] .config-dialog .el-dialog__title {\n  float: left;\n  font-size: 0.8rem;\n}\n[data-v-482549f9] .config-dialog .el-dialog__header {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 2.5rem;\n  line-height: 2.5rem;\n  border-bottom: 0.05rem solid #ddd;\n  padding: 0 0.4rem;\n}\n.dialog-content[data-v-482549f9] {\n  height: 100%;\n  padding: 0.5rem;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.dialog-footer[data-v-482549f9] {\n  border-top: 0.05rem solid #ddd;\n  padding: 0 0.4rem;\n  height: 2.5rem;\n}\n",""]),e.exports=o},156:(e,o,t)=>{(o=t(3645)(!1)).push([e.id,".quotation-view[data-v-7b8424bd] {\n  width: 100%;\n  height: 100%;\n  padding: 0.5rem 0.5rem 0.5rem 2rem;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.quotation-view .config-btn[data-v-7b8424bd] {\n  border-radius: 25rem !important;\n  width: 7.5rem !important;\n  background: #56bdbd;\n  color: #fff;\n}\n.quotation-view .config-btn[data-v-7b8424bd]:hover {\n  background: #0c2639;\n}\n[data-v-7b8424bd] .el-form-item {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  margin-bottom: 0.5rem;\n}\n[data-v-7b8424bd] .el-input-number--small {\n  width: 8.5rem;\n  line-height: 1.5rem;\n}\n[data-v-7b8424bd] .el-radio-button--small .el-radio-button__inner {\n  width: 5.75rem;\n  padding: 0.45rem 0;\n  display: inline-block;\n}\n[data-v-7b8424bd] .el-switch.is-checked .el-switch__core .el-switch__action {\n  left: 100%;\n  margin-left: calc(-0.75rem - 0.05rem);\n}\n",""]),e.exports=o},9943:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>v});var l=t(8133);const n=(0,l.withScopeId)("data-v-7b8424bd");(0,l.pushScopeId)("data-v-7b8424bd");const a={class:"quotation-view"},r={style:{"text-align":"center","padding-top":"20px"}},i=(0,l.createTextVNode)("生成报价单");(0,l.popScopeId)();const p=n(((e,o,t,p,s,d)=>{const m=(0,l.resolveComponent)("el-switch"),c=(0,l.resolveComponent)("el-date-picker"),u=(0,l.resolveComponent)("el-input"),f=(0,l.resolveComponent)("el-input-number"),b=(0,l.resolveComponent)("el-radio-button"),g=(0,l.resolveComponent)("el-radio-group"),y=(0,l.resolveComponent)("el-form-item"),h=(0,l.resolveComponent)("el-col"),k=(0,l.resolveComponent)("el-row"),w=(0,l.resolveComponent)("el-form"),v=(0,l.resolveComponent)("el-button"),x=(0,l.resolveComponent)("common-dialog");return e.isShowDialog?((0,l.openBlock)(),(0,l.createBlock)(x,{key:0,title:"导出报价单",width:"1000px",onHandleCancel:o[1]||(o[1]=o=>e.isShowDialog=!1)},{content:n((()=>[(0,l.createVNode)("div",a,[(0,l.createVNode)(w,{"label-position":"left","label-width":"180px",model:e.quotationFormConfig.form},{default:n((()=>[((0,l.openBlock)(!0),(0,l.createBlock)(l.Fragment,null,(0,l.renderList)(e.quotationFormConfig.widgets,(o=>((0,l.openBlock)(),(0,l.createBlock)(k,{key:o},{default:n((()=>[((0,l.openBlock)(!0),(0,l.createBlock)(l.Fragment,null,(0,l.renderList)(o.widgetList,(o=>((0,l.openBlock)(),(0,l.createBlock)(h,{key:o.id,span:o.layout.span,offset:o.layout.offset},{default:n((()=>[(0,l.createVNode)(y,{label:o.label,style:o.layout.item},{default:n((()=>["line"===o.formItemType?((0,l.openBlock)(),(0,l.createBlock)("div",{key:0,style:o.style},null,4)):(0,l.createCommentVNode)("",!0),"switch"===o.formItemType?((0,l.openBlock)(),(0,l.createBlock)(m,{key:1,modelValue:e.quotationFormConfig.form[o.prop],"onUpdate:modelValue":t=>e.quotationFormConfig.form[o.prop]=t,class:"ml-2",size:"small",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","onUpdate:modelValue"])):(0,l.createCommentVNode)("",!0),"date-picker"===o.formItemType?((0,l.openBlock)(),(0,l.createBlock)(c,{key:2,style:{width:"170px"},size:"small",modelValue:e.quotationFormConfig.form[o.prop],"onUpdate:modelValue":t=>e.quotationFormConfig.form[o.prop]=t,type:"date",placeholder:o.placeholder,format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(0,l.createCommentVNode)("",!0),"input"===o.formItemType?((0,l.openBlock)(),(0,l.createBlock)(u,{key:3,style:{width:"170px"},size:"small",placeholder:o.placeholder,modelValue:e.quotationFormConfig.form[o.prop],"onUpdate:modelValue":t=>e.quotationFormConfig.form[o.prop]=t},null,8,["placeholder","modelValue","onUpdate:modelValue"])):(0,l.createCommentVNode)("",!0),"input-number"===o.formItemType?((0,l.openBlock)(),(0,l.createBlock)(f,{key:4,size:"small",modelValue:e.quotationFormConfig.form[o.prop],"onUpdate:modelValue":t=>e.quotationFormConfig.form[o.prop]=t,min:o.min,max:o.max,step:o.step,precision:o.precision},null,8,["modelValue","onUpdate:modelValue","min","max","step","precision"])):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(g,{modelValue:e.quotationFormConfig.form[o.prop],"onUpdate:modelValue":t=>e.quotationFormConfig.form[o.prop]=t,size:"small"},{default:n((()=>[((0,l.openBlock)(!0),(0,l.createBlock)(l.Fragment,null,(0,l.renderList)(o.options,(e=>((0,l.openBlock)(),(0,l.createBlock)(b,{key:e.value,label:e.value},{default:n((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.label),1)])),_:2},1032,["label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label","style"])])),_:2},1032,["span","offset"])))),128))])),_:2},1024)))),128))])),_:1},8,["model"]),(0,l.createVNode)("div",r,[(0,l.createVNode)(v,{class:"config-btn",size:"large",onClick:e.onGeneroateQuotation},{default:n((()=>[i])),_:1},8,["onClick"])])])])),_:1})):(0,l.createCommentVNode)("",!0)}));t(6992),t(3948),t(6456),t(5827),t(8674),t(7727),t(4916);var s=t(2119),d=t(5497);const m=(0,l.withScopeId)("data-v-482549f9");(0,l.pushScopeId)("data-v-482549f9");const c={class:"dialog-content"},u={class:"dialog-footer"};(0,l.popScopeId)();const f=m(((e,o,t,n,a,r)=>{const i=(0,l.resolveComponent)("el-dialog");return(0,l.openBlock)(),(0,l.createBlock)("div",null,[(0,l.createVNode)(i,{title:t.title&&t.title.length>30?t.title.substring(0,30)+"...":t.title,modelValue:a.showDialog,"onUpdate:modelValue":o[1]||(o[1]=e=>a.showDialog=e),"before-close":r.handleClose,width:t.width,fullscreen:t.fullscreen,top:t.top,"close-on-click-modal":!1,center:"","destroy-on-close":"","custom-class":"config-dialog"},{default:m((()=>[(0,l.createVNode)("div",c,[(0,l.renderSlot)(e.$slots,"content")]),(0,l.withDirectives)((0,l.createVNode)("div",u,[(0,l.renderSlot)(e.$slots,"footer")],512),[[l.vShow,t.showFooter]])])),_:3},8,["title","modelValue","before-close","width","fullscreen","top"])])})),b={name:"CenterDialog",props:{title:{type:String,default:()=>""},width:{type:String,default:()=>"30%"},top:{type:String,default:()=>"10vh"},showFooter:{type:Boolean,default:()=>!1},fullscreen:{type:Boolean,default:()=>!1}},data:()=>({showDialog:!0}),mounted(){},methods:{handleClose(e){this.showDialog=!1,e(),this.$emit("handle-cancel")}}};t(3586);b.render=f,b.__scopeId="data-v-482549f9";const g=b;t(5306);var y=t(9669),h=t.n(y);h().interceptors.request.use((e=>{let o=window.localStorage.getItem("sid");return o&&(e.headers.common.token=o),e}),(e=>Promise.reject(e)));const k=h().create({timeout:18e6});k.interceptors.response.use((function(e){return 200==+e.status?e.data:(console.warn("[Fetch Status Error]\n",e),Promise.reject(e.data))}),(function(e){console.error("[Fetch Status Error]\n",e);const{response:o}=e||{},{data:t,status:l}=o||{};let n=l;return t&&(n=t.error_code||t.ErrorCode||t.err_code),n+""=="401"&&window.parent&&window.parent.location.replace("/page/authority/login/login.html"),Promise.reject({status:500,msg:e})})),k.interceptors.request.use((function(e){try{e.headers.token=window.localStorage.getItem("sid")}catch(e){console.log(e)}return e}),(function(e){return console.error("[Fetch Status Error]\n",e),Promise.reject(e)}));const w=(0,l.defineComponent)({name:"QuotationConfig",props:{menuList:Array,position:Object},components:{CommonDialog:g},setup(e){const o=(0,s.yj)();let t=(0,l.ref)(!1);const n=(0,l.reactive)({form:{isOutputGjLogo:!0,expireTime:"",projectNo:"",projectName:"",agentName:"",preSaleName:"",customerInfo:"",jgtdxtzkl:.3,jkxtzkl:.3,upsxtzkl:.3,bzfcxtzkl:.3,dcxtzkl:.3,ybfzkl:.3,pdxtzkl:.3,gcaztsfyzkl:.3,zlxtzkl:.3,bjqdscwd:"",isOutputShippingCost:!0,isOutputInstallCost:!0,isOutputCost:!0},widgets:[{widgetList:[{id:"1919191",formItemType:"switch",label:"是否输出共济logo",prop:"isOutputGjLogo",layout:{span:12}},{id:"181818",formItemType:"date-picker",label:"报价单有效期至",prop:"expireTime",placeholder:"请选择日期",layout:{span:12}},{id:"171717",formItemType:"input",label:"项目编号",prop:"projectNo",placeholder:"请从erp复制",layout:{span:12}},{id:"1616161",formItemType:"input",label:"项目名称",prop:"projectName",placeholder:"请输入",layout:{span:12}},{id:"151515",formItemType:"input",label:"商务人员",prop:"agentName",placeholder:"请输入",layout:{span:12}},{id:"141414",formItemType:"input",label:"售前技术人员",prop:"preSaleName",placeholder:"请输入",layout:{span:12}},{id:"141414",formItemType:"input",label:"客户信息",prop:"customerInfo",placeholder:"请输入",layout:{span:12}},{id:"87651212",formItemType:"line",style:"border: 1px solid rgb(238, 238, 238);margin-left: -180px",layout:{span:23,item:"height: 0;"}}]},{widgetList:[{id:"131313",formItemType:"input-number",label:"机柜通道系统折扣率",prop:"jgtdxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"121212",formItemType:"input-number",label:"监控系统折扣率",prop:"jkxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"111111",formItemType:"input-number",label:"UPS统折扣率",prop:"upsxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"1010101",formItemType:"input-number",label:"包装辅材系统折扣率",prop:"bzfcxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"999",formItemType:"input-number",label:"电池系统折扣率",prop:"dcxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"888",formItemType:"input-number",label:"运保费折扣率",prop:"ybfzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"777",formItemType:"input-number",label:"配电系统折扣率",prop:"pdxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"666",formItemType:"input-number",label:"工程安装调试费用折扣率",prop:"gcaztsfyzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"555",formItemType:"input-number",label:"制冷系统折扣率",prop:"zlxtzkl",precision:2,step:.1,min:.3,max:1,layout:{span:12}},{id:"56785456",formItemType:"line",style:"border: 1px solid rgb(238, 238, 238);margin-left: -180px",layout:{span:23,item:"height: 0;"}}]},{widgetList:[{id:"444",formItemType:"radio-button",label:"报价清单输出维度",prop:"bjqdscwd",options:[{label:"输出L2级清单",value:"输出L2级清单"},{label:"输出L2,L3级清单",value:"输出L2，L3级清单"}],layout:{span:12}},{id:"333",formItemType:"radio-button",label:"输出运保费用明细清单",prop:"isOutputShippingCost",options:[{label:"输出",value:!0},{label:"不输出",value:!1}],layout:{span:12,offset:0}},{id:"222",formItemType:"radio-button",label:"输出安装费用明细清单",prop:"isOutputInstallCost",options:[{label:"输出",value:!0},{label:"不输出",value:!1}],layout:{span:12}},{id:"111",formItemType:"radio-button",label:"成本清单输出",prop:"isOutputCost",options:[{label:"输出",value:!0},{label:"不输出",value:!1}],layout:{span:12,offset:0}}]}]});return{quotationFormConfig:n,onGeneroateQuotation:()=>{console.log(e.menuList),console.log(n.form);let t={};e.menuList.forEach((e=>{e.widgetList.reduce(((e,o)=>{let{name:t,value:l,type:n}=o.config.formMap;return e[t]="number"===n?Number(l):l,e}),t)}));let l=Object.assign({},e.position,t,n.form);const{userId:a,userName:r}=o.query;h().post(`/api/v1/doCost?userId=${a}&userName=${r}`,l,{responseType:"blob"}).then((e=>{if(200===e.status&&e.data.size>0){let o=e.headers["content-disposition"].match(/filename=(.*)/)[1];((e,o,t)=>{const l=document.createElement("a");l.download=`${o}`,l.style.display="none";let n=null;if(t){const o=new Blob([e]);n=URL.createObjectURL(o)}else n=URL.createObjectURL(e);l.href=n,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)})(e.data,decodeURI(o),!1)}else{var o;(0,d.z8)({showClose:!0,type:"error",message:(null==e||null===(o=e.data)||void 0===o?void 0:o.message)||"下载失败！"})}}),(e=>{(0,d.z8)({showClose:!0,type:"error",message:"服务器异常！"})})).finally((()=>{}))},isShowDialog:t,openQuotationDialog:()=>{t.value=!0},closeQuotationDialog:()=>{t.value=!1}}}});t(6446);w.render=p,w.__scopeId="data-v-7b8424bd";const v=w},3586:(e,o,t)=>{var l=t(7562);"string"==typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);(0,t(5346).Z)("24a8a1ba",l,!0,{})},6446:(e,o,t)=>{var l=t(156);"string"==typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);(0,t(5346).Z)("ebc90356",l,!0,{})}}]);